<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta charset="utf-8">
<link rel="stylesheet" href="style.css">

<title>
Jamie Bali
</title>
</head>

<body style="background-color:#151515">
<div id="cover">
    <div id="coverTitle">
        Jamie's Project Blog
    </div>
    <div id="coverSubtitle">
        Ideas, Rambles, Projects, and More.    
    </div>
</div>

</body>

<script>
    let request = new XMLHttpRequest();
    request.open("GET", 'https://api.github.com/repos/JamieBali/JamieBali.github.io/contents/posts');
    request.send();
    request.onload = () =>{
        var data = (JSON.parse(request.response));
        data.reverse().forEach(createBlock);
    }

    function createBlock(item){
        let subreq = new XMLHttpRequest();
        subreq.open("GET", 'https://raw.githubusercontent.com/JamieBali/JamieBali.github.io/main/posts/' + item.name);
        subreq.send();
        subreq.onload = () =>{
            var splitText = subreq.response.split("|");
            console.log(splitText[0])
            var element = document.createElement("div");
            element.className = "linkBlock";

            var img = document.createElement('img');
            img.src = 'https://raw.githubusercontent.com/JamieBali/JamieBali.github.io/main/images/' + splitText[1];
            img.className = 'blockPicture';
            element.appendChild(img);

            var namesplit = item.name.split("-");
            var dateRelease = namesplit[0] + "-" + namesplit[1] + "-" + namesplit[2];

            var titleElement = document.createElement("div");
            titleElement.className = "blockTitle";
            titleElement.appendChild(document.createTextNode(splitText[0]));
            
            var dateElement = document.createElement("div");
            dateElement.className = "blockDate";
            dateElement.appendChild(document.createTextNode(dateRelease));

            titleElement.appendChild(dateElement);

            var textElement = document.createElement("div");
            textElement.className = "blockText";
            textElement.appendChild(document.createTextNode(splitText[2]));

            titleElement.appendChild(textElement);
            element.appendChild(titleElement);
        
            document.getElementById('cover').appendChild(element);
        }
    }
</script>
</html>